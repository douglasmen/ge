<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:plcf="http://www.powerlogic.com.br/plcf" 
	xmlns:tr="http://myfaces.apache.org/trinidad" 
	xmlns:trh="http://myfaces.apache.org/trinidad/html">  
	<ui:composition> 
		<plcf:tabela tituloChave="registronotasfundamental.subdetalhe.1.titulo.comp"> 
			<plcf:linha> 
				<plcf:celula/>
				<!--<plcf:celula rendered="#{empty requestScope.visualizaDocumentoPlc}">
					<plcf:tituloExclusao/>
				</plcf:celula>-->
				<plcf:celula>
					<plcf:titulo tituloChave="label.aluno"/>
				</plcf:celula>
				<plcf:celula>
					<plcf:titulo tituloChave="label.notaTrabalho"/>
				</plcf:celula>
				<plcf:celula>
					<plcf:titulo tituloChave="label.notaProva"/>
				</plcf:celula>
				<plcf:celula>
					<plcf:titulo tituloChave="label.avaliacao"/>
				</plcf:celula>
				<plcf:celula>
					<plcf:titulo tituloChave="label.conceito"/>
				</plcf:celula>
				<plcf:celula>
					<plcf:titulo tituloChave="label.aulasDadas"/>
				</plcf:celula>
				<plcf:celula>
					<plcf:titulo tituloChave="label.faltas"/>
				</plcf:celula>
				<plcf:celula>
					<plcf:titulo tituloChave="label.total"/>
				</plcf:celula>
			</plcf:linha>  
			<plcf:iteracao id="registroNotasFundamentalSubDet" value="#{item.registroNotasFundamentalSubDet}"  var="itemSubDet" varStatus="index" > 
				<plcf:linha> 
					<plcf:celula styleClass="celulaFormularioContador">
						<plcf:contador  />
					</plcf:celula>
					<!--<plcf:celula styleClass="celulaFormularioCaixaMarcacao" rendered="#{empty requestScope.visualizaDocumentoPlc}">
						<plcf:caixaExclusao id="indExcPlc"  />
					</plcf:celula>-->
					<plcf:celula>
						<plcf:exibe id="aluno" value="#{itemSubDet.nomeAluno}" inlineStyle="color: #3D4F57; font-size: 12px;" rendered="#{itemSubDet.notaReprovada == null || itemSubDet.notaReprovada == 'N'}"/>
						<!-- quando a nota for reprovada apresenta o nome do aluno em vermelho -->
						<plcf:exibe id="alunoVerm" value="#{itemSubDet.nomeAluno}" inlineStyle="color: #FF0000; font-size: 12px;" rendered="#{itemSubDet.notaReprovada == 'S'}"/>
					</plcf:celula>
					<plcf:celula>
						<plcf:numerico id="notaTrabalho" value="#{itemSubDet.notaTrabalho}"    ajudaChave="ajuda.notaTrabalho" onblur="somaTotal(#{index.index},#{plcItensStatus.index})" />
					</plcf:celula>
					<plcf:celula>
						<plcf:numerico id="notaProva" value="#{itemSubDet.notaProva}"    ajudaChave="ajuda.notaProva" onblur="somaTotal(#{index.index},#{plcItensStatus.index})" />
					</plcf:celula>
					<plcf:celula>
						<plcf:numerico id="avaliacao" value="#{itemSubDet.avaliacao}"    ajudaChave="ajuda.avaliacao" onblur="somaTotal(#{index.index},#{plcItensStatus.index})"/>
					</plcf:celula>
					<plcf:celula>
						<plcf:numerico id="conceito" value="#{itemSubDet.conceito}"    ajudaChave="ajuda.conceito" onblur="somaTotal(#{index.index},#{plcItensStatus.index})"/>
					</plcf:celula>
					<plcf:celula>
						<plcf:texto id="aulasDadas" value="#{itemSubDet.aulasDadas}" formato="NUMERICO"   ajudaChave="ajuda.aulasDadas" />
					</plcf:celula>
					<plcf:celula>
						<plcf:texto id="faltas" value="#{itemSubDet.faltas}" formato="NUMERICO"   ajudaChave="ajuda.faltas" />
					</plcf:celula>
					<plcf:celula>
						<plcf:numerico id="total" value="#{itemSubDet.total}"    ajudaChave="ajuda.total" onfocus="this.blur()" />
					</plcf:celula>
				</plcf:linha> 
			</plcf:iteracao> 
		</plcf:tabela> 
		
<script avaliar="S">
//<![CDATA[

//esconder o botao novo do sub-det
for (var i=0;i<30;i++){
	document.getElementById('corpo:formulario:registroNotasFundamentalDet:'+i+':novoComponente').style.display = 'none';
}

function somaTotal( indexSub,indexDet ){
	
	var soma = 0;
	var trabalho = document.getElementById('corpo:formulario:registroNotasFundamentalDet:'+indexDet+':registroNotasFundamentalSubDet:'+indexSub+':notaTrabalho').value;
	var prova = document.getElementById('corpo:formulario:registroNotasFundamentalDet:'+indexDet+':registroNotasFundamentalSubDet:'+indexSub+':notaProva').value;
	var avaliacao = document.getElementById('corpo:formulario:registroNotasFundamentalDet:'+indexDet+':registroNotasFundamentalSubDet:'+indexSub+':avaliacao').value;
	var conceito = document.getElementById('corpo:formulario:registroNotasFundamentalDet:'+indexDet+':registroNotasFundamentalSubDet:'+indexSub+':conceito').value;

	if(trabalho == null || trabalho == '' ){
		trabalho = 0;
	}
	else{
		trabalho = trabalho.replace(",",".");
	}
	if(prova == null || prova == '' ){
		prova = 0;
	}
	else{
		prova = prova.replace(",",".");
	}
	if(avaliacao == null || avaliacao == '' ){
		avaliacao = 0;
	}
	else{
		avaliacao = avaliacao.replace(",",".");
	}
	if(conceito == null || conceito == '' ){
		conceito = 0;
	}
	else{
		conceito = conceito.replace(",",".");
	}

	soma = parseFloat(trabalho) + parseFloat(prova) + parseFloat(avaliacao) + parseFloat(conceito);
	var somaStr = new String(soma);
	somaStr = somaStr.replace(".",",");
	document.getElementById('corpo:formulario:registroNotasFundamentalDet:'+indexDet+':registroNotasFundamentalSubDet:'+indexSub+':total').value = somaStr;
	
}

//]]>
</script>
		
	</ui:composition> 
</html>
